<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>Man page of PCAP_LIST_DATALINKS</TITLE>
<LINK REL="stylesheet" type="text/css" href="../style_manpages.css">
<meta charset="utf-8">
</HEAD><BODY>
<H1>Man page of PCAP_LIST_DATALINKS</H1>
Section: Misc. Reference Manual Pages (3PCAP)<BR>Updated: 25 July 2018<BR>
<A HREF="./">Return to Main Contents</A><HR>
<DIV class=version_boilerplate>
<H4>This man page documents libpcap version 1.9.1.</H4>
Your system may have a different version installed, possibly with some
local modifications.  To achieve the best results, please make sure this
version of this man page suits your needs.  If necessary, try to look for
a different version on this web site or in the man pages available in your
installation.
</DIV>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

pcap_list_datalinks, pcap_free_datalinks - get a list of link-layer header
types supported by a capture device, and free that list
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<PRE>
<B>#include &lt;pcap/pcap.h&gt;
</B>
<B>int pcap_list_datalinks(pcap_t *p, int **dlt_buf);
void pcap_free_datalinks(int *dlt_list);
</B></PRE>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

<B>pcap_list_datalinks()</B>

is used to get a list of the supported link-layer header types of the
interface associated with the pcap descriptor.
<B>pcap_list_datalinks()</B>

allocates an array to hold the list and sets
<I>*dlt_buf</I>

to point to that array.
<P>

The caller is responsible for freeing the array with
<B>pcap_free_datalinks()</B>,

which frees the list of link-layer header types pointed to by
<I>dlt_list</I>.

<P>

It must not be called on a pcap descriptor created by
<B><A HREF='./pcap_create.3pcap.html'>pcap_create</A>(3PCAP)</B>

that has not yet been activated by
<B><A HREF='./pcap_activate.3pcap.html'>pcap_activate</A>(3PCAP)</B>.

<A NAME="lbAE">&nbsp;</A>
<H2>RETURN VALUE</H2>

<B>pcap_list_datalinks()</B>

returns the number of link-layer header types in the array on success,
<B>PCAP_ERROR_NOT_ACTIVATED</B>

if called on a capture handle that has been created but not activated,
and
<B>PCAP_ERROR</B>

on other errors.
If
<B>PCAP_ERROR</B>

is returned,
<B><A HREF='./pcap_geterr.3pcap.html'>pcap_geterr</A>(3PCAP)</B>

or
<B><A HREF='./pcap_geterr.3pcap.html'>pcap_perror</A>(3PCAP)</B>

may be called with
<I>p</I>

as an argument to fetch or display the error text.
<A NAME="lbAF">&nbsp;</A>
<H2>SEE ALSO</H2>

<A HREF='./pcap.3pcap.html'>pcap</A>(3PCAP),
<A HREF='./pcap_datalink_val_to_name.3pcap.html'>pcap_datalink_val_to_name</A>(3PCAP),
<A HREF="./pcap-linktype.7.html">pcap-linktype</A>(7)
<P>

<HR>
This document was created by
man2html,
using the manual pages from "The Tcpdump Group" git repositories.<BR>
Time: 10:40:21 GMT, October 05, 2021
<a href="https://validator.w3.org/check?uri=referer">[Valid HTML 4.01]</a>
<a href="https://jigsaw.w3.org/css-validator/check/referer">[Valid CSS]</a>
</BODY>
</HTML>
